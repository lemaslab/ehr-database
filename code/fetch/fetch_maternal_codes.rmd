---
title: "fetch maternal codes & link the mom-baby ID"
author: "Dominick Lemas"
date: "11/14/2023"
output: html_document

---

```{r, include=FALSE}
##-------------- 
# **************************************************************************** #
# ***************                Project Overview              *************** #
# **************************************************************************** #

# Author:      Dominick Lemas
# Date:        Nov 14, 2023 
# Modify:      Feb 18, 2025
# IRB:         UFHealth Early Life Exposures and Pediatric Outcomes (IRB201601899) 

# R version 4.3.1 (2023-06-16 ucrt) -- "Beagle Scouts"
# Copyright (C) 2023 The R Foundation for Statistical Computing
# Platform: x86_64-w64-mingw32/x64 (64-bit)

# **************************************************************************** #
# ***************                Description                   *************** #
# **************************************************************************** #

# PLAN: consolidate ICD9/10 codes into a single file

```


```{r, message=FALSE}

# **************************************************************************** #
# ***************                Library                       *************** #
# **************************************************************************** #

library(tidyverse)
library(lubridate)

```

```{r, message=FALSE}

# Define the data directory
data_dir <- "V:/FACULTY/DJLEMAS/EHR_Data/processed/10year_data/"

# Function to load RDA file and return its object
load_rda <- function(file_name) {
  data_path <- file.path(data_dir, file_name)
  load(data_path)  # Loads objects into the environment
  return(get(ls()[length(ls())]))  # Retrieve the last loaded object
}

# Load mom-baby link
mom_baby_link <- load_rda("mom_baby_link.rda")

# Load maternal ICD codes
mom_all_icd_codes <- load_rda("mom_all_icd_codes.rda")

# Perform the merge
mom_all_icd_codes_02_2025 <- full_join(mom_all_icd_codes, mom_baby_link, by = "part_id_mom")

# Print summary
print(dim(mom_all_icd_codes_02_2025))
head(mom_all_icd_codes_02_2025)

```


```{r}

## EXPORT to Sharedrive
file_name="mom_all_icd_codes_02_2025.rda"
data_export_directory=paste0("V:/FACULTY/DJLEMAS/EHR_Data/processed/10year_data/") 
data_export_path=paste0(data_export_directory,file_name)
mom_all_icd_codes_02_2025 %>% save(mom_all_icd_codes_02_2025, file=data_export_path)
```

`

